from web3 import Web3
from eth_abi import decode
import requests
# Calldata en formato hexadecimal
calldata = "3593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000067aea11c00000000000000000000000000000000000000000000000000000000000000040b000604000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000de0b6b3a7640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002b0d500b1d8e8ef31e21c99d1db9a6444d3adf12700001f43c499c542cef5e3811e1192ce70d8cc03d5c3359"

try:
    # Extraemos el selector de función (primeros 4 bytes)
    function_selector = calldata[:8]
    print(f"Selector de función: 0x{function_selector}")
    recipient_address = "0x" + calldata[-40:]
    print(f"recipient_address: {recipient_address}")
except Exception as e:
    print(f"Error al decodificar: {str(e)}")

def get_token_id_from_address(contract_address, platform="polygon-pos"):
    url = f"https://api.coingecko.com/api/v3/coins/{platform}/contract/{recipient_address}"
    response = requests.get(url)
    #print(response.json())
    if response.status_code == 200:
        data = response.json()
        return data["id"]  # Devuelve el token_id
    else:
        print(f"Error {response.status_code}: {response.text}")
        return None

print(get_token_id_from_address(recipient_address))